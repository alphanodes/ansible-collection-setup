# Fail2Ban configuration file
#
# Redmine failed login detection via nginx access log
#
# Matches POST /login requests that return:
#   200 = failed authentication (form re-rendered with error)
#   422 = invalid CSRF token (common in dictionary attacks)
#
# Successful logins return 302 redirect and are NOT matched.
#
# Requires logpath = nginx access log in jail configuration.

[Definition]

failregex = ^<HOST> \S+ \S+ \[.*?\] "POST /login\b[^"]*" (200|422)

ignoreregex =
