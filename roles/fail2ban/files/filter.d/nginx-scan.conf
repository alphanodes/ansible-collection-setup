# Fail2Ban configuration file
#
# Nginx vulnerability scan detection via access log
#
# Detects common vulnerability scans and probing attempts:
# - Probing for sensitive files (.env, .git, .htpasswd, wp-config)
# - Scanning for PHP/ASP/JSP/CGI on non-PHP servers
# - WordPress/phpMyAdmin/adminer path probing
#
# Three groups:
# 1. Sensitive files: suspicious regardless of response code
# 2. Script file extensions: suspicious with error responses only
# 3. Known exploit paths: suspicious with error responses only
#
# Requires logpath = nginx access log in jail configuration.

[Definition]

failregex = ^<HOST> \S+ \S+ \[.*?\] "(GET|POST|PUT|HEAD) /[^"]*(\.env|\.git/|\.svn/|\.DS_Store|\.htpasswd|wp-config)[^"]*" \d+
            ^<HOST> \S+ \S+ \[.*?\] "(GET|POST|PUT|HEAD) /[^"]*\.(php|asp|aspx|jsp|cgi)\b[^"]*" (400|403|404|405|500|502|503)
            ^<HOST> \S+ \S+ \[.*?\] "(GET|POST|PUT|HEAD) /(wp-login|wp-admin|wp-content|wp-includes|phpmyadmin|phpMyAdmin|pma|adminer|cgi-bin|xmlrpc\.php)[^"]*" (400|403|404|405|500|502|503)

ignoreregex =
