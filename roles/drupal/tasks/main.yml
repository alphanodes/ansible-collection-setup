---
- name: Include vars
  ansible.builtin.import_tasks: include-vars.yml

- name: Include setup tasks
  ansible.builtin.include_tasks: setup.yml
  tags:
    - drupal

- name: Include instance tasks
  ansible.builtin.include_tasks: instance.yml
  tags:
    - drupal
  loop: "{{ drupal_instances }}"
  loop_control:
    loop_var: drupal_instance
  when: >
    drupal_instance.state is undefined
    or drupal_instance.state == 'active'
